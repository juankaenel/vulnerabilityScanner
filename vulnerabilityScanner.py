import portScanner
from colorama import Fore

targets_ip = input(Fore.BLUE + '[*] Ingrese el objetivo para analizar vulnerabilidades en puertos abiertos: ')
port_number = int(input('[*] Ingrese la cantidad de puertos a escanear (ej: 100 - primeros 100 puertos): '))
vuln_file= input('[*] Ingrese la ruta de la base de datos de los servicios vulnerables: ')

target = portScanner.PortScan(targets_ip,port_number)
target.scan()

with open(vuln_file, 'r') as file:
    count = 0
    for banner in target.banners:
        file.seek(0)
        for line in file.readlines():
            if line.strip() in banner:
                print('\n'+Fore.RED + "[!] Servicio Vulnerable - " + banner + " - corriendo en el puerto: " + str(target.open_ports[count])+'\n')
        count += 1

